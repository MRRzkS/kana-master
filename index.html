<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kana Master</title>
    <style>
        :root {
            --primary: linear-gradient(135deg, #1a535c 0%, #2d2d2d 100%);
            --secondary: linear-gradient(135deg, #4ecdc4 0%, #88d8b0 100%);
            --accent: linear-gradient(135deg, #ff6b6b 0%, #ff8c94 100%);
            --bg: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            --text: #ffffff;
            --card-bg: rgba(0, 0, 0, 0.3);
        }

        [data-theme="light"] {
            --primary: linear-gradient(135deg, #88d8b0 0%, #f0f0f0 100%);
            --secondary: linear-gradient(135deg, #ffef96 0%, #fff3d1 100%);
            --accent: linear-gradient(135deg, #ff8c94 0%, #ffc2c9 100%);
            --bg: linear-gradient(135deg, #f0f0f0 0%, #ffffff 100%);
            --text: #2d2d2d;
            --card-bg: rgba(255, 255, 255, 0.8);
        }

        body {
            margin: 0;
            min-height: 100vh;
            background: var(--bg);
            color: var(--text);
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: 0.3s;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24"><path fill="none" stroke="%23fff" stroke-width="2" d="M12 2L2 12l10 10 10-10L12 2zm0 6l6 6m-6 6l6-6"/></svg>') 12 12, auto;
        }

        .game-container {
            text-align: center;
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            position: relative;
            width: 90%;
            max-width: 500px;
            transform-style: preserve-3d;
        }

        .controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 10px;
            z-index: 2;
        }

        .control-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text);
        }

        .kana-display {
            font-size: 6rem;
            margin: 30px 0;
            background: var(--accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transform: perspective(500px) rotateY(0deg);
            transition: transform 0.6s;
        }

        .progress-bar {
            height: 10px;
            background: var(--secondary);
            margin: 20px 0;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            width: 100%;
            background: var(--accent);
            transition: width 0.1s linear;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 25px 0;
        }

        .stat-box {
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            backdrop-filter: blur(5px);
        }

        input {
            padding: 12px;
            font-size: 1rem;
            border: 2px solid var(--secondary);
            border-radius: 10px;
            background: transparent;
            color: var(--text);
            width: calc(100% - 24px);
            margin: 10px 0;
        }

        button {
            padding: 12px 25px;
            background: var(--accent);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: 0.3s;
            width: 100%;
        }

        .mode-selection {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .mode-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
            background: var(--secondary);
            color: var(--text);
        }

        .active-mode {
            background: var(--accent);
            color: white;
        }

        .cursor-effect {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--accent);
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        @media (max-width: 500px) {
            .kana-display { font-size: 4rem; }
            input { font-size: 1.2rem; }
            .stat-box { padding: 10px; }
        }
    </style>
</head>
<body>
    <div class="controls">
        <button class="control-btn mode-toggle" onclick="toggleTheme()">üåô</button>
        <button class="control-btn" onclick="togglePause()">‚è∏Ô∏è</button>
        <button class="control-btn" onclick="resetGame()">üîÑ</button>
    </div>
    
    <div class="game-container">
        <h1>Kana Master</h1>
        <div class="mode-selection">
            <button class="mode-btn active-mode" onclick="setMode('hiragana')">Hiragana</button>
            <button class="mode-btn" onclick="setMode('katakana')">Katakana</button>
        </div>
        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>
        <div class="kana-display" id="kana">„ÅÇ</div>
        <div id="paused-message" style="display: none; font-size: 1.5rem; margin: 20px;">Paused</div>
        <input type="text" id="answer" placeholder="Type romaji here" onkeypress="handleKeyPress(event)">
        <button onclick="checkAnswer()">Submit</button>
        <div class="feedback" id="feedback"></div>
        <div class="stats">
            <div class="stat-box">Score: <span id="score">0</span></div>
            <div class="stat-box">Correct: <span id="correct">0</span></div>
            <div class="stat-box">Wrong: <span id="wrong">0</span></div>
            <div class="stat-box">Progress: <span id="progress">1/46</span></div>
        </div>
    </div>

    <div class="cursor-effect"></div>

    <script>
        const hiraganaFull = [
            {kana: '„ÅÇ', romaji: 'a'}, {kana: '„ÅÑ', romaji: 'i'}, {kana: '„ÅÜ', romaji: 'u'}, {kana: '„Åà', romaji: 'e'}, {kana: '„Åä', romaji: 'o'},
            {kana: '„Åã', romaji: 'ka'}, {kana: '„Åç', romaji: 'ki'}, {kana: '„Åè', romaji: 'ku'}, {kana: '„Åë', romaji: 'ke'}, {kana: '„Åì', romaji: 'ko'},
            {kana: '„Åï', romaji: 'sa'}, {kana: '„Åó', romaji: 'shi'}, {kana: '„Åô', romaji: 'su'}, {kana: '„Åõ', romaji: 'se'}, {kana: '„Åù', romaji: 'so'},
            {kana: '„Åü', romaji: 'ta'}, {kana: '„Å°', romaji: 'chi'}, {kana: '„Å§', romaji: 'tsu'}, {kana: '„Å¶', romaji: 'te'}, {kana: '„Å®', romaji: 'to'},
            {kana: '„Å™', romaji: 'na'}, {kana: '„Å´', romaji: 'ni'}, {kana: '„Å¨', romaji: 'nu'}, {kana: '„Å≠', romaji: 'ne'}, {kana: '„ÅÆ', romaji: 'no'},
            {kana: '„ÅØ', romaji: 'ha'}, {kana: '„Å≤', romaji: 'hi'}, {kana: '„Åµ', romaji: 'fu'}, {kana: '„Å∏', romaji: 'he'}, {kana: '„Åª', romaji: 'ho'},
            {kana: '„Åæ', romaji: 'ma'}, {kana: '„Åø', romaji: 'mi'}, {kana: '„ÇÄ', romaji: 'mu'}, {kana: '„ÇÅ', romaji: 'me'}, {kana: '„ÇÇ', romaji: 'mo'},
            {kana: '„ÇÑ', romaji: 'ya'}, {kana: '„ÇÜ', romaji: 'yu'}, {kana: '„Çà', romaji: 'yo'},
            {kana: '„Çâ', romaji: 'ra'}, {kana: '„Çä', romaji: 'ri'}, {kana: '„Çã', romaji: 'ru'}, {kana: '„Çå', romaji: 're'}, {kana: '„Çç', romaji: 'ro'},
            {kana: '„Çè', romaji: 'wa'}, {kana: '„Çí', romaji: 'wo'}, {kana: '„Çì', romaji: 'n'},
            {kana: '„Åå', romaji: 'ga'}, {kana: '„Åé', romaji: 'gi'}, {kana: '„Åê', romaji: 'gu'}, {kana: '„Åí', romaji: 'ge'}, {kana: '„Åî', romaji: 'go'},
            {kana: '„Åñ', romaji: 'za'}, {kana: '„Åò', romaji: 'ji'}, {kana: '„Åö', romaji: 'zu'}, {kana: '„Åú', romaji: 'ze'}, {kana: '„Åû', romaji: 'zo'},
            {kana: '„Å†', romaji: 'da'}, {kana: '„Å¢', romaji: 'ji'}, {kana: '„Å•', romaji: 'zu'}, {kana: '„Åß', romaji: 'de'}, {kana: '„Å©', romaji: 'do'},
            {kana: '„Å∞', romaji: 'ba'}, {kana: '„Å≥', romaji: 'bi'}, {kana: '„Å∂', romaji: 'bu'}, {kana: '„Åπ', romaji: 'be'}, {kana: '„Åº', romaji: 'bo'},
            {kana: '„Å±', romaji: 'pa'}, {kana: '„Å¥', romaji: 'pi'}, {kana: '„Å∑', romaji: 'pu'}, {kana: '„Å∫', romaji: 'pe'}, {kana: '„ÅΩ', romaji: 'po'}
        ];

        const katakanaFull = [
            {kana: '„Ç¢', romaji: 'a'}, {kana: '„Ç§', romaji: 'i'}, {kana: '„Ç¶', romaji: 'u'}, {kana: '„Ç®', romaji: 'e'}, {kana: '„Ç™', romaji: 'o'},
            {kana: '„Ç´', romaji: 'ka'}, {kana: '„Ç≠', romaji: 'ki'}, {kana: '„ÇØ', romaji: 'ku'}, {kana: '„Ç±', romaji: 'ke'}, {kana: '„Ç≥', romaji: 'ko'},
            {kana: '„Çµ', romaji: 'sa'}, {kana: '„Ç∑', romaji: 'shi'}, {kana: '„Çπ', romaji: 'su'}, {kana: '„Çª', romaji: 'se'}, {kana: '„ÇΩ', romaji: 'so'},
            {kana: '„Çø', romaji: 'ta'}, {kana: '„ÉÅ', romaji: 'chi'}, {kana: '„ÉÑ', romaji: 'tsu'}, {kana: '„ÉÜ', romaji: 'te'}, {kana: '„Éà', romaji: 'to'},
            {kana: '„Éä', romaji: 'na'}, {kana: '„Éã', romaji: 'ni'}, {kana: '„Éå', romaji: 'nu'}, {kana: '„Éç', romaji: 'ne'}, {kana: '„Éé', romaji: 'no'},
            {kana: '„Éè', romaji: 'ha'}, {kana: '„Éí', romaji: 'hi'}, {kana: '„Éï', romaji: 'fu'}, {kana: '„Éò', romaji: 'he'}, {kana: '„Éõ', romaji: 'ho'},
            {kana: '„Éû', romaji: 'ma'}, {kana: '„Éü', romaji: 'mi'}, {kana: '„É†', romaji: 'mu'}, {kana: '„É°', romaji: 'me'}, {kana: '„É¢', romaji: 'mo'},
            {kana: '„É§', romaji: 'ya'}, {kana: '„É¶', romaji: 'yu'}, {kana: '„É®', romaji: 'yo'},
            {kana: '„É©', romaji: 'ra'}, {kana: '„É™', romaji: 'ri'}, {kana: '„É´', romaji: 'ru'}, {kana: '„É¨', romaji: 're'}, {kana: '„É≠', romaji: 'ro'},
            {kana: '„ÉØ', romaji: 'wa'}, {kana: '„É≤', romaji: 'wo'}, {kana: '„É≥', romaji: 'n'},
            {kana: '„Ç¨', romaji: 'ga'}, {kana: '„ÇÆ', romaji: 'gi'}, {kana: '„Ç∞', romaji: 'gu'}, {kana: '„Ç≤', romaji: 'ge'}, {kana: '„Ç¥', romaji: 'go'},
            {kana: '„Ç∂', romaji: 'za'}, {kana: '„Ç∏', romaji: 'ji'}, {kana: '„Ç∫', romaji: 'zu'}, {kana: '„Çº', romaji: 'ze'}, {kana: '„Çæ', romaji: 'zo'},
            {kana: '„ÉÄ', romaji: 'da'}, {kana: '„ÉÇ', romaji: 'ji'}, {kana: '„ÉÖ', romaji: 'zu'}, {kana: '„Éá', romaji: 'de'}, {kana: '„Éâ', romaji: 'do'},
            {kana: '„Éê', romaji: 'ba'}, {kana: '„Éì', romaji: 'bi'}, {kana: '„Éñ', romaji: 'bu'}, {kana: '„Éô', romaji: 'be'}, {kana: '„Éú', romaji: 'bo'},
            {kana: '„Éë', romaji: 'pa'}, {kana: '„Éî', romaji: 'pi'}, {kana: '„Éó', romaji: 'pu'}, {kana: '„Éö', romaji: 'pe'}, {kana: '„Éù', romaji: 'po'}
        ];

        let currentMode = 'hiragana';
        let currentKana = {};
        let score = 0;
        let correct = 0;
        let wrong = 0;
        let answered = 0;
        let timerInterval;
        let timeRemaining = 5000;
        let isPaused = false;
        const totalKana = 46;
        let kanaPool = [...hiraganaFull];
        let currentIndex = 0;

        function setMode(mode) {
            currentMode = mode;
            kanaPool = mode === 'hiragana' ? [...hiraganaFull] : [...katakanaFull];
            shuffleArray(kanaPool);
            resetGame();
            updateProgress();
            newQuestion();
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function resetGame() {
            currentIndex = 0;
            correct = 0;
            wrong = 0;
            score = 0;
            answered = 0;
            isPaused = false;
            clearInterval(timerInterval);
            document.getElementById('kana').style.display = 'block';
            document.getElementById('paused-message').style.display = 'none';
            document.querySelector('.control-btn:nth-child(2)').textContent = '‚è∏Ô∏è';
            updateStats();
            newQuestion();
        }

        function newQuestion() {
            if (isPaused) return;
            clearTimeout(timerInterval);
            currentKana = kanaPool[currentIndex];
            document.getElementById('kana').textContent = currentKana.kana;
            document.getElementById('answer').value = '';
            document.getElementById('feedback').style.opacity = 0;
            document.querySelector('.progress-fill').style.width = '100%';
            
            timeRemaining = 5000;
            updateProgressBar();
            
            timerInterval = setInterval(() => {
                timeRemaining -= 100;
                updateProgressBar();
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    checkAnswer(true);
                }
            }, 100);
            
            document.querySelector('.kana-display').style.transform = 'perspective(500px) rotateY(360deg)';
        }

        function updateProgressBar() {
            const progress = (timeRemaining / 5000) * 100;
            document.querySelector('.progress-fill').style.width = `${progress}%`;
        }

        function checkAnswer(timeout = false) {
            if (isPaused) return;
            clearInterval(timerInterval);
            const userAnswer = document.getElementById('answer').value.toLowerCase();
            const correctAnswer = currentKana.romaji.toLowerCase();
            
            if (!timeout && userAnswer === correctAnswer) {
                correct++;
                score += 10;
                document.getElementById('feedback').textContent = 'Correct!';
                document.getElementById('feedback').style.color = '#4CAF50';
            } else {
                wrong++;
                score -= 5;
                const message = timeout ? 'Time out!' : 'Wrong!';
                document.getElementById('feedback').textContent = `${message} Correct: ${correctAnswer}`;
                document.getElementById('feedback').style.color = '#ff6b6b';
            }

            answered++;
            updateStats();
            document.getElementById('feedback').style.opacity = 1;
            
            if (answered < totalKana) {
                currentIndex++;
                setTimeout(newQuestion, 1500);
            } else {
                setTimeout(() => {
                    alert(`All ${currentMode} completed!\nFinal Score: ${score}`);
                    resetGame();
                }, 1500);
            }
        }

        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('correct').textContent = correct;
            document.getElementById('wrong').textContent = wrong;
            updateProgress();
        }

        function updateProgress() {
            document.getElementById('progress').textContent = `${answered + 1}/46`;
        }

        function toggleTheme() {
            const body = document.body;
            const isLight = body.dataset.theme === 'light';
            body.dataset.theme = isLight ? '' : 'light';
            localStorage.setItem('theme', body.dataset.theme);
            document.querySelector('.mode-toggle').textContent = isLight ? 'üåô' : '‚òÄÔ∏è';
        }

        function handleKeyPress(e) {
            if (e.key === 'Enter' && !isPaused) checkAnswer();
        }

        function togglePause() {
            isPaused = !isPaused;
            const pauseBtn = document.querySelector('.control-btn:nth-child(2)');
            const kanaDisplay = document.getElementById('kana');
            const pausedMessage = document.getElementById('paused-message');
            
            if (isPaused) {
                clearInterval(timerInterval);
                kanaDisplay.style.display = 'none';
                pausedMessage.style.display = 'block';
                pauseBtn.textContent = '‚ñ∂Ô∏è';
            } else {
                kanaDisplay.style.display = 'block';
                pausedMessage.style.display = 'none';
                pauseBtn.textContent = '‚è∏Ô∏è';
                newQuestion();
            }
        }

        document.addEventListener('mousemove', (e) => {
            const cursor = document.querySelector('.cursor-effect');
            cursor.style.left = `${e.pageX}px`;
            cursor.style.top = `${e.pageY}px`;
            cursor.style.opacity = '0.3';
            setTimeout(() => cursor.style.opacity = '0', 500);
        });

        // Initialize
        document.body.dataset.theme = localStorage.getItem('theme') || '';
        document.querySelector('.mode-toggle').textContent = document.body.dataset.theme === 'light' ? '‚òÄÔ∏è' : 'üåô';
        setMode(currentMode);
    </script>
</body>
</html>